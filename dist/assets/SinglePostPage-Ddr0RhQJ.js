import{i as _,r,j as e,k as b,l as y,L as h,m as N,g as k}from"./index-DxnEfs_J.js";import{g as u,m as S}from"./blogCategories-Bhl1X6cR.js";function P(){const{slug:c}=_(),[l,d]=r.useState(null),[p,f]=r.useState(!0),[i,m]=r.useState(0);r.useEffect(()=>{async function s(){try{const o=await k.get(`/blog/posts/${c}`);d(o)}catch(o){console.error("API error, falling back to mocks:",o);const n=S.find(v=>v.slug===c);d(n?{post:{title:n.title,category:n.category||"conseils",published_at:new Date().toISOString(),first_name:n.author,last_name:"",main_image_url:n.image,body:n.content},slideshow_images:[]}:null)}finally{f(!1)}}s()},[c]);const t=[];l?.post.main_image_url&&t.push({url:l.post.main_image_url,alt:l.post.title}),l?.slideshow_images?.length>0&&l.slideshow_images.forEach(s=>{t.push({url:s.image_url,alt:s.alt_text||l.post.title})});const g=r.useCallback(()=>{m(s=>s===t.length-1?0:s+1)},[t.length]),x=()=>{m(s=>s===0?t.length-1:s-1)};if(r.useEffect(()=>{if(t.length<=1)return;const s=setInterval(()=>{g()},4e3);return()=>clearInterval(s)},[i,g,t.length]),p)return e.jsx("div",{className:"post-loading",children:"Chargement..."});if(!l)return e.jsx("div",{className:"post-not-found",children:"Article introuvable"});const{post:a}=l,j=new Date(a.published_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"});return e.jsxs("div",{className:"single-post-page",children:[e.jsx("title",{children:`${a.title} | Foodmoov`}),e.jsxs("div",{className:"post-container",children:[e.jsx("div",{className:"post-hero-section",children:t.length>0?e.jsxs("div",{className:"custom-slider",children:[e.jsx("img",{src:t[i].url,alt:t[i].alt,className:"slider-image"}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"slider-btn prev",onClick:x,children:e.jsx(b,{})}),e.jsx("button",{className:"slider-btn next",onClick:g,children:e.jsx(y,{})}),e.jsx("div",{className:"slider-dots",children:t.map((s,o)=>e.jsx("span",{className:`dot ${o===i?"active":""}`,onClick:()=>m(o)},o))})]})]}):e.jsx("div",{className:"no-image-banner",children:"Foodmoov Blog"})}),e.jsxs("div",{className:"post-header",children:[e.jsx(h,{to:`/blog?categorie=${a.category||"conseils"}`,className:"post-category-orig",style:{backgroundColor:u(a.category)?.color||"var(--primary-color)"},children:u(a.category)?.name||a.category||"Conseils"}),e.jsx("h1",{children:a.title}),e.jsxs("p",{className:"post-meta",children:["Par ",a.first_name," ",a.last_name," - ",j]})]}),e.jsx("div",{className:"post-content",dangerouslySetInnerHTML:{__html:a.body}}),e.jsxs(h,{to:"/blog",className:"back-to-blog-link",children:[e.jsx(N,{})," Retour au blog"]})]})]})}export{P as default};
