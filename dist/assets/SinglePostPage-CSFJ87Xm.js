import{h as j,r as o,j as s,i as v,k as _,L as b,l as N,g as k}from"./index-DtLecUcG.js";import{m as S}from"./mockPosts-Bi876rFD.js";function F(){const{slug:c}=j(),[a,d]=o.useState(null),[h,u]=o.useState(!0),[r,m]=o.useState(0);o.useEffect(()=>{async function e(){try{const n=await k.get(`/blog/posts/${c}`);d(n)}catch(n){console.error("API error, falling back to mocks:",n);const i=S.find(x=>x.slug===c);d(i?{post:{title:i.title,category:"Conseils",published_at:new Date().toISOString(),first_name:i.author,last_name:"",main_image_url:i.image,body:i.content},slideshow_images:[]}:null)}finally{u(!1)}}e()},[c]);const t=[];a?.post.main_image_url&&t.push({url:a.post.main_image_url,alt:a.post.title}),a?.slideshow_images?.length>0&&a.slideshow_images.forEach(e=>{t.push({url:e.image_url,alt:e.alt_text||a.post.title})});const g=o.useCallback(()=>{m(e=>e===t.length-1?0:e+1)},[t.length]),p=()=>{m(e=>e===0?t.length-1:e-1)};if(o.useEffect(()=>{if(t.length<=1)return;const e=setInterval(()=>{g()},4e3);return()=>clearInterval(e)},[r,g,t.length]),h)return s.jsx("div",{className:"post-loading",children:"Chargement..."});if(!a)return s.jsx("div",{className:"post-not-found",children:"Article introuvable"});const{post:l}=a,f=new Date(l.published_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"});return s.jsxs("div",{className:"single-post-page",children:[s.jsx("title",{children:`${l.title} | Foodmoov`}),s.jsxs("div",{className:"post-container",children:[s.jsx("div",{className:"post-hero-section",children:t.length>0?s.jsxs("div",{className:"custom-slider",children:[s.jsx("img",{src:t[r].url,alt:t[r].alt,className:"slider-image"}),t.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"slider-btn prev",onClick:p,children:s.jsx(v,{})}),s.jsx("button",{className:"slider-btn next",onClick:g,children:s.jsx(_,{})}),s.jsx("div",{className:"slider-dots",children:t.map((e,n)=>s.jsx("span",{className:`dot ${n===r?"active":""}`,onClick:()=>m(n)},n))})]})]}):s.jsx("div",{className:"no-image-banner",children:"Foodmoov Blog"})}),s.jsxs("div",{className:"post-header",children:[s.jsx("span",{className:"post-category-orig",children:l.category||"Conseils"}),s.jsx("h1",{children:l.title}),s.jsxs("p",{className:"post-meta",children:["Par ",l.first_name," ",l.last_name," â€¢ ",f]})]}),s.jsx("div",{className:"post-content",dangerouslySetInnerHTML:{__html:l.body}}),s.jsxs(b,{to:"/blog",className:"back-to-blog-link",children:[s.jsx(N,{})," Retour au blog"]})]})]})}export{F as default};
